<html>
<head>
<title>To-do list for DeuTex</title>
</head>
<body>

	<h1>To-do list for DeuTex</h1>

		<h2>Directives file</h2>

<ul>
<li>In the directives file and textures files, "include" directive to include
the rest of another block/file.

<p><li>In the directives file and textures files, allow references to
environment variables (E.G. <code>$E(name)</code>)

<p><li>In the directives file and textures files, allow user variables (E.G.
    <code>$(name)</code>)

<p><li>Make it easier to let a texture have a description identical to another
texture

<p><li>In the directives file, add a mean to import all/only named/all except
named flats as patches.

<p><li>In the directives file, add a mean to import all/only named/all except
named patches as flats. This implies 1) accepting flats larger than
64&times;64 (by clipping) 2) converting transparent pixels to a certain
colour (which one ?).

<p><li>In the directives file, add a mean to automatically generate a texture
for all/only named/all except named patches. The height of the automatic
texture is 128, its width is the least power of two wide enough to contain the
patch. The automatic texture is filled with the patch by tiling, starting from
the top left corner. The name of the automatic texture is the name of the
patch.

<p><li>Instead of allowing any and all characters in the script file, require
them to be quoted. And, when doing <code>-xtract</code>, produce the script
file with the appropriate quotes... Since, under Unix, the only characters
that are not allowed in a file name are NUL and "<code>/</code>", I don't see
why DeuTex should prevent users from extracting lumps with weird characters in
their names. However, that might cause compatilibity problems with the DOS
version.

</ul>

		<h2>Game support</h2>

<ul>

<p><li>Doom alpha <code>GNUM[0-9]</code>&nbsp;:
  <ul>
  <li>find name for 10x12, preferably ending in "p" (xxx),
  <li>implement <code>IDENTxxx()</code>,
  <li>add <code>[xxx]</code> section to <code>wadinfo.txt</code>,
  <li>make list of lumps that used to go in <code>lumps/</code> and now go in
  <code>xxx/</code> and put that in <code>changes.html</code>,
  <li>create corresponding <code>-sprites</code>-like option
  </ul>

<p><li>When extracting the Doom alpha 0.2 iwad, "<code>Can't find PNAMES in
wad</code>".

<p><li>DeuTex should not look for <code>doom.wad</code> in the directory set
by <code>-heretic</code> !

<p><li>Heretic: <code>E2END</code> is extracted with the wrong palette.

<p><li>Hexen: does not extract graphics quite correctly (applies transparent
colour translation to opaque images such as <code>FINALE1</code> and
<code>FINALE2</code>. This is probably related to [1].

<p><li>Make sure that support for Strife is complete.

</ul>

		<h2>Graphics</h2>

<ul>
<p><li>Patches &gt; 255 high

<p><li>The presence of the GIF routines might prevent DeuTex to be distributed
in the main section of Debian. Would it be sufficient to #ifdef them out ?

<p><li>Determine why converting Doom graphics to PPM and back does not yield
the same thing. This also happens with BMP but much less so.

<p>Update 2000-01-04&nbsp;: for example, with Heretic, patch
<code>WALL17</code> has its (4Eh, 50h, 4Dh) pixels turned into (4Eh, 4Eh, 4Eh).
It seems DeuTex sometimes uses a close match even when an exact match exists.

<p><li>Bug: some flats seem to be extracted with certain pixels set to the
transparent colour (Doom's <code>CEIL4_1</code>). DeuTex 3.6 for DOS exhibits
the same problem [1].

<p><li>Building seems to be slower than extracting. Perhaps
<code>RAWtoPIC()</code> could use some optimization.

<p><li>Include the Gimp and PSP palettes in the distribution.

<p><li>For people who have old graphics files generated by DeuTex 3 with cyan
(0, 255, 255) as the transparent colour&nbsp;: it would be nice if DeuTex 4
could import those files automatically. The way I see it, if no transparent
pixel has been found in an image so far and if a cyan pixel is found, a warning
is emitted ("<code>Warning: xxxxxxxx.xxx: assuming the transparent colour is
cyan.</code>") and the transparent colour for this image is set to cyan. This
would make for a smooth transition from DeuTex 3 to DeuTex 4. There should be a
command-line switch to disable that feature.

<p><li>Sneas are supported when doing <code>-xtract</code> but not when doing
<code>-build</code> (they're ignored). Fix that, or at least mention it
somewhere. Though I don't see many people wanting to <em>make</em> wads for
Doom alpha anyway...

</ul>

		<h2>Sound</h2>

<ul>

<p><li>Regarding audio support, Matthew W. Miller
&lt;<code>mattm@infinet.com</code>&gt; offered the following comment on
1999-07-04&nbsp;:

<blockquote>
<p>Audio handling in deutex (I'm referring to the irix
5.3 version's included source code) is, I believe, based on dmgraph, but
is pretty dire in any case.

<p>Imported sounds are all resampled to 11025 Hz, even though that
hasn't been necessary since some time between v1.2 and v1.666 (basically,
any version that uses the item-respawn sound has the improved sound
engine). Exasperatingly, lxdoom (or maybe sndserv?) takes several steps
back by expecting sounds to be *raw* 11025 Hz data. You may be able to
set new options to reflect this.

<p>Also, one would hope that eventually one or more of the source
ports will start to support bitrates other than 8 bit, and (maybe?) stereo
samples. You may want to start leaning on various source ports'
programmers to get their acts together and start coming to some sort of
agreement. ;)

<p>Importation of .wav files is pretty crufty. Like dmgraph before
it, the deutex 5.3 source expects there to be just one big 'data' chunk,
and doesn't notice the 'info' chunks that certain stupid Windows programs
(*cough*cough*CoolEdit*GoldWave*cough*) insist on putting in (usually with
copyright messages for the program itself, which in a just world would be
illegal). Greater explanation of all this whacky chunk business can be
found at:
<a href="http://www.compsoc.man.ac.uk/~maniac/resource_web/wav_file_format/">
<code>http://www.compsoc.man.ac.uk/~maniac/resource_web/wav_file_format/</code></a>
(wav1.htm, wav2.htm, wav3.htm, 4.htm, 5.htm)

<p>Essentially, you want to clip out the first 'data' chunk and ignore crap
like 'info', 'inam', 'list', or whatever.
</blockquote>

<p><li>Fix this&nbsp;:
  <pre>atc4:/doom/dev/test/wav/16$ deutex -doom /doom/doom -xtract ../16bit44k.wad 
DeuTex 4.0.3 Copyright 1994,95 O.Montanuy, Copyright 1999 A.Majorel
  Ported to DOS, Unix, OS/2, Linux, SGiX, DEC Alpha.
  Thanx to M.Mathews, P.Allansson, C.Rossi, J.Bonfield, U.Munk.
  This program is freeware.
Type "deutex -help" to get the list of commands.
Main directory: /doom/doom.
Extracting entries from WAD ../16bit44k.wad
Reading WAD /doom/doom/doom.wad:        (2306 entries)
Reading WAD ../16bit44k.wad:    (1 entries)
PWAD entry identification...done
Color palette is Doom
Warning: ** Appending to file ./wadinfo.txt **
Extracting Levels...
Extracting Lumps...
Extracting Sounds...

Bug: *** not a WAVE ***
Please report that bug.</pre>

<p><li>WAV to Doom sound: the warning "shrinking ... to 11025" should mention
the name of the file or appear only once.

<p><li>Look into importing sounds as .wav's. What are the highest supported
sample rates and resolution&nbsp;? Seems to depend on the engine.

</ul>

		<h2>Command line</h2>

<ul>
<p><li>The command line interface is not always intuitive and it's fussy about
the position of certain options. <code>-iwad</code> seems to be ineffective if
placed last. <code>-xtract</code> and friends must be placed last if they don't
have all their arguments.

<p><li>Options shouldn't care whether there is space between them and their
argument. Hmm... or should they&nbsp;?

<p><li><code>-check</code> shouldn't require an argument. It should use the
iwad by default.

<p><li><code>-main</code> should be implemented for DeuTex as well.

<p><li>Matthew Miller wants to be able to specify the name of the iwad instead
of just its path (this is how it should have been done from the start, IMHO).
Possible ways to do that&nbsp;:

  <ul>
  <li><code>stat()</code> the argument to <code>-doom</code>,
  <code>-heretic</code>, etc. If it's a file and not a directory, use that.

  <li>Look for a different basename in the iwad directory, depending on the
  option through which the directory was specified. E.G. if it was set with
  <code>-doom2</code>, look for <code>doom2.wad</code> first. And if
  <code>doom2.wad</code> was not found, emit a warning. <code>-doom</code> and
  <code>-heretic</code> should look for all basenames because that's what
  previous versions of DeuTex did.

  <li>Add an option to specify the name of the iwad file, without specifying
  which iwad it is and let DeuTex guess what needs to be guessed. Apparently,
  there's already such an option (<code>-main</code>) but it's for DeuSF only.
  Why&nbsp;?

  </ul>

</ul>

		<h2>Documentation</h2>

<ul>
<p><li>It's in shambles.

<p><li>Mention that negative patch Y-offsets are forced to 0 by
the engine.

<p><li>Mention that sneaps are extracted but not built.

<p><li>Man page: mention that some options are DeuTex-only, not DeuSF.

<p><li>Man page: insert <code>`deutex -man`</code> automatically.

</ul>

		<h2>Platform</h2>

<ul>
<p><li>Alpha port: look into 64-bit longs.

<p><li>Borland C: to revive the port, must find a way to make all pointers
implicitly huge.

</ul>

		<h2>Misc.</h2>

<ul>

<p><li>TBD: New options <code>-fstart</code> and <code>-fend</code> to control
the start-of-flats and end-of-flats markers used in pwads. Default to
<code>FF_START</code> and <code>F_END</code> respectively.
<strong>Warning:</strong> here again, don't use those options just because
they're here. The default markers are perfectly fine, and they conform to the
de-facto standard. If you deviate from them, you're asking for trouble.

<p><li><code>-f_end</code>

<p><li>Why does "<code>deutex -ipf alpha -doom .. -sprites -graphics -patches
-xtract</code>" trigger <code>"Error: *** Can't open file ./lumps/titlepic.lmp
***</code>"&nbsp;?

<p><li><code>todo.html</code> grows faster than <code>changes.html</code>. Fix
that. <code>;-)</code>

<p><li>There are too many warnings for a 25-line display. Keep a copy in
<code>deutex.log</code>&nbsp;?

<p><li><code>-usedidx</code>: don't count sneats (<code>-nosneats</code> ?). 

</ul>

</body>
</html>
